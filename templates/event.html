{% extends "base.html" %}

{% block title %}{{ event.event_name }} - アークナイツ ストーリーアーカイブ{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <ol>
        <li><a href="{{ index_path }}">ホーム</a></li>
        <li><a href="{{ index_path }}#events">イベント一覧</a></li>
        <li class="active">{{ event.event_name }}</li>
    </ol>
</nav>

<section class="event-header">
    <h2>{{ event.event_name }}</h2>
    <div class="event-info">
        <p class="event-type">{{ event.activity_info.display_type }}</p>
        <p class="event-date">開催期間: {{ event.start_date }} ~ {{ event.end_date }}</p>
    </div>
</section>

<section class="stories-section">
    <h3>ストーリー一覧</h3>
    {% if event.total_wordcount_display %}
    <div class="total-wordcount">
        <span class="wordcount-label">合計文字数:</span>
        <span class="wordcount-value">{{ event.total_wordcount_display }}</span>
    </div>
    {% endif %}
    
    <div class="stories-list">
        {% for story in stories %}
        <article class="story-item{% if not story.has_story %} story-no-content{% endif %}">
            <div class="story-header">
                <h4 class="story-title">
                    {% if story.has_story %}
                    <a href="stories/{{ story.file_name }}.html">
                        {% if story.stage_code %}{{ story.stage_code }}{% endif %}
                        {% if story.stage_name %}{{ story.stage_name }}{% else %}{{ story.story_name }}{% endif %}
                    </a>
                    {% else %}
                    <span class="story-title-no-link">
                        {% if story.stage_code %}{{ story.stage_code }}{% endif %}
                        {% if story.stage_name %}{{ story.stage_name }}{% else %}{{ story.story_name }}{% endif %}
                    </span>
                    {% endif %}
                </h4>
                <div class="story-meta">
                    {% if story.story_phase %}
                    <span class="story-phase story-phase-{{ story.story_phase.replace('戦闘前', 'before').replace('戦闘後', 'after').replace('間章', 'story') }}">
                        {{ story.story_phase }}
                    </span>
                    {% endif %}
                    {% if story.danger_level and story.danger_level != '-' %}
                    <span class="danger-level">{{ story.danger_level }}</span>
                    {% endif %}
                    {% if story.word_count_display %}
                    <span class="word-count">{{ story.word_count_display }}</span>
                    {% endif %}
                    {% if not story.has_story %}
                    <span class="no-story-indicator">ストーリーなし</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="story-footer">
                {% if story.has_story %}
                <a href="stories/{{ story.file_name }}.html" class="btn btn-secondary">
                    ストーリーを読む
                </a>
                {% else %}
                <span class="btn btn-disabled" disabled>
                    ストーリーなし
                </span>
                {% endif %}
            </div>
        </article>
        {% endfor %}
    </div>
</section>

<nav class="navigation">
    <a href="{{ index_path }}" class="btn btn-back">イベント一覧に戻る</a>
</nav>
{% endblock %}