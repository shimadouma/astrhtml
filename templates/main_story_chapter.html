{% extends "base.html" %}

{% block title %}{{ chapter_title }} - メインストーリー - アークナイツ ストーリーアーカイブ{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ css_path }}main_story.css">
{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <ol>
        <li><a href="{{ index_path }}">ホーム</a></li>
        <li><a href="../index.html">メインストーリー</a></li>
        <li class="active">{{ zone_info.short_title }}</li>
    </ol>
</nav>

<section class="chapter-header">
    <div class="chapter-info">
        <div class="chapter-number-large">
            {{ zone_info.short_title }}
        </div>
        <div class="chapter-details">
            <h2>{{ chapter_title }}</h2>
            <p class="episode-title">{{ episode_title }}</p>
        </div>
    </div>
</section>

<section class="stories-section">
    <h3>ストーリー一覧</h3>
    
    <div class="stories-list">
        {% for story in stories %}
        <article class="story-item{% if not story.has_story %} story-no-content{% endif %}">
            <div class="story-header">
                <h4 class="story-title">
                    {% if story.has_story %}
                    <a href="stories/{{ story.file_name }}.html">
                        {{ story.stage_code }}
                        {% if story.story_name %}
                            {{ story.story_name }}
                        {% else %}
                            {{ story.stage_name }}
                        {% endif %}
                    </a>
                    {% else %}
                    <span class="story-title-no-link">
                        {{ story.stage_code }}
                        {% if story.story_name %}
                            {{ story.story_name }}
                        {% else %}
                            {{ story.stage_name }}
                        {% endif %}
                    </span>
                    {% endif %}
                </h4>
                <div class="story-meta">
                    {% if story.story_phase %}
                    <span class="story-phase story-phase-{{ story.story_phase | replace('戦闘前', 'before') | replace('戦闘後', 'after') | replace('間章', 'story') }}">
                        {{ story.story_phase }}
                    </span>
                    {% endif %}
                    
                    {% if story.danger_level %}
                    <span class="danger-level">{{ story.danger_level }}</span>
                    {% endif %}
                    
                    {% if not story.has_story %}
                    <span class="no-story-indicator">ストーリーなし</span>
                    {% endif %}
                </div>
            </div>
            
            {% if story.story_info %}
            <div class="story-description">
                <p>{{ story.story_info }}</p>
            </div>
            {% endif %}
            
            <div class="story-footer">
                {% if story.has_story %}
                <a href="stories/{{ story.file_name }}.html" class="btn btn-secondary">
                    ストーリーを読む
                </a>
                {% else %}
                <span class="btn btn-disabled" disabled>
                    ストーリーなし
                </span>
                {% endif %}
            </div>
        </article>
        {% endfor %}
    </div>
</section>

<nav class="navigation">
    <a href="../index.html" class="btn btn-back">章一覧に戻る</a>
</nav>
{% endblock %}